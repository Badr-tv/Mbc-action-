<video id="player" controls autoplay style="width:100vw; height:100vh; background:black;"></video>

<script>
  async function fetchStreamLink() {
    try {
      const response = await fetch("https://cors-anywhere.herokuapp.com/https://www.elahmad.com/tv/mobiletv/glarb.php?id=baraem");
      const html = await response.text();
      const match = html.match(/https:\/\/games1\.elahmad\.online\/[^"]+\.m3u8\?token=[^"]+/);
      if (match && match[0]) {
        return match[0];
      } else {
        throw new Error("لم يتم العثور على الرابط.");
      }
    } catch (error) {
      console.error("خطأ في جلب الرابط:", error);
      return null;
    }
  }

  async function startPlayer() {
    const video = document.getElementById("player");
    const streamURL = await fetchStreamLink();
    if (streamURL) {
      video.src = streamURL;
      video.load();
      video.play();
    }
  }

  startPlayer();
  setInterval(startPlayer, 2.5 * 60 * 60 * 1000);
</script>
