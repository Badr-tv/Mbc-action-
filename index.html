<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>براعم مباشر تلقائي</title>
</head>
<body style="margin:0; padding:0; background:black;">

<video id="videoPlayer" controls autoplay style="width:100vw; height:100vh; background:black;">
  متصفحك لا يدعم تشغيل الفيديو المباشر.
</video>

<script>
  async function getStreamURL() {
    try {
      // تجاوز حماية CORS باستخدام proxy مجاني
      const proxy = "https://cors-anywhere.herokuapp.com/";
      const sourceUrl = "https://www.elahmad.com/tv/mobiletv/glarb.php?id=baraem";

      const response = await fetch(proxy + sourceUrl);
      const html = await response.text();

      // استخراج رابط m3u8 الذي يحتوي على التوكن
      const match = html.match(/https:\/\/games1\.elahmad\.online\/[^"]+\.m3u8\?token=[^"]+/);

      if (match && match[0]) {
        return match[0];
      } else {
        console.error("لم يتم العثور على الرابط.");
        return null;
      }

    } catch (err) {
      console.error("خطأ في جلب الرابط:", err);
      return null;
    }
  }

  async function playStream() {
    const video = document.getElementById("videoPlayer");
    const streamURL = await getStreamURL();
    if (streamURL) {
      video.src = streamURL;
      video.load();
      video.play();
    }
  }

  // أول تشغيل
  playStream();

  // تحديث كل 2.5 ساعة (9000000 ms)
  setInterval(playStream, 2.5 * 60 * 60 * 1000);
</script>

</body>
</html>
